{"ast":null,"code":"\"use client\";// CommentSection.jsx - Component for displaying and adding comments\n// Used on the video page\nimport{useState}from\"react\";import\"./CommentSection.css\";import{useAuth}from\"../../context/AuthContext\";import CommentItem from\"./CommentItem\";import{toast}from\"react-toastify\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function CommentSection(_ref){let{videoId,comments=[],onAddComment}=_ref;const[commentText,setCommentText]=useState(\"\");const[isSubmitting,setIsSubmitting]=useState(false);const{currentUser,user}=useAuth();// Use either currentUser or user, whichever is available\nconst authUser=currentUser||user;// Ensure comments is always an array\nconst safeComments=Array.isArray(comments)?comments:[];// Handle comment submission\nconst handleSubmitComment=async e=>{e.preventDefault();if(!commentText.trim()){return;}if(!authUser){toast.error(\"You must be logged in to comment\");return;}try{setIsSubmitting(true);// Call the onAddComment function passed from parent\nif(onAddComment){await onAddComment(commentText);}// Clear the comment input\nsetCommentText(\"\");}catch(error){console.error(\"Error adding comment:\",error);toast.error(\"Failed to add comment. Please try again.\");}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"comment-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"comment-section__title\",children:[safeComments.length,\" \",safeComments.length===1?\"Comment\":\"Comments\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-section__form-container\",children:[authUser?/*#__PURE__*/_jsx(\"img\",{src:authUser.profilePicture||\"/default-avatar.png\",alt:authUser.username,className:\"comment-section__user-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"comment-section__user-avatar comment-section__user-avatar--placeholder\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"comment-section__form\",onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:authUser?\"Add a comment...\":\"Sign in to comment\",value:commentText,onChange:e=>setCommentText(e.target.value),className:\"comment-section__input\",disabled:!authUser||isSubmitting}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-section__form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"comment-section__cancel-btn\",onClick:()=>setCommentText(\"\"),disabled:!commentText||isSubmitting,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"comment-section__submit-btn\",disabled:!commentText||isSubmitting,children:isSubmitting?\"Commenting...\":\"Comment\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-section__list\",children:safeComments.length>0?safeComments.map(comment=>/*#__PURE__*/_jsx(CommentItem,{comment:comment},comment.id)):/*#__PURE__*/_jsx(\"p\",{className:\"comment-section__no-comments\",children:\"No comments yet. Be the first to comment!\"})})]});}export default CommentSection;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}