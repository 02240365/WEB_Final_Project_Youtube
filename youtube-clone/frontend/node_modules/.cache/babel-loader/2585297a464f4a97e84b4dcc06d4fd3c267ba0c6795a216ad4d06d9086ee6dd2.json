{"ast":null,"code":"\"use client\";// UploadVideo.jsx - Video upload page component\n// Allows creators to upload videos with metadata\nimport _objectSpread from\"/Users/sonamzangmo/Desktop/WEB_Final_Project_Youtube/youtube-clone/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import\"./UploadVideo.css\";import{uploadVideo}from\"../services/api\";import{useAuth}from\"../context/AuthContext\";import{toast}from\"react-toastify\";// Video categories\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const categories=[\"Entertainment\",\"Music\",\"Gaming\",\"News\",\"Sports\",\"Education\",\"Science & Technology\",\"Comedy\",\"Movies\",\"Anime\",\"Cooking\",\"Travel\",\"Fashion\",\"Fitness\",\"Other\"];function UploadVideo(){const[formData,setFormData]=useState({title:\"\",description:\"\",category:\"\",tags:\"\",videoFile:null,thumbnail:null});const[uploading,setUploading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const[errors,setErrors]=useState({});const[dragActive,setDragActive]=useState(false);const{currentUser}=useAuth();const navigate=useNavigate();// Handle input changes\nconst handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));// Clear error when user starts typing\nif(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:\"\"}));}};// Handle file selection\nconst handleFileSelect=e=>{const{name,files}=e.target;if(files&&files[0]){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:files[0]}));// Clear error\nif(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:\"\"}));}}};// Handle drag and drop\nconst handleDrag=e=>{e.preventDefault();e.stopPropagation();if(e.type===\"dragenter\"||e.type===\"dragover\"){setDragActive(true);}else if(e.type===\"dragleave\"){setDragActive(false);}};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setDragActive(false);if(e.dataTransfer.files&&e.dataTransfer.files[0]){const file=e.dataTransfer.files[0];// Check if it's a video file\nif(file.type.startsWith(\"video/\")){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{videoFile:file}));}else{toast.error(\"Please select a valid video file\");}}};// Validate form\nconst validateForm=()=>{const newErrors={};if(!formData.title.trim()){newErrors.title=\"Title is required\";}else if(formData.title.length>100){newErrors.title=\"Title must be less than 100 characters\";}if(!formData.description.trim()){newErrors.description=\"Description is required\";}if(!formData.category){newErrors.category=\"Category is required\";}if(!formData.videoFile){newErrors.videoFile=\"Video file is required\";}else{// Check file size (max 500MB)\nconst maxSize=500*1024*1024;// 500MB in bytes\nif(formData.videoFile.size>maxSize){newErrors.videoFile=\"Video file must be less than 500MB\";}// Check file type\nif(!formData.videoFile.type.startsWith(\"video/\")){newErrors.videoFile=\"Please select a valid video file\";}}setErrors(newErrors);return Object.keys(newErrors).length===0;};// Handle form submission\nconst handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}try{setUploading(true);setUploadProgress(0);// Prepare upload data\nconst uploadData={title:formData.title,description:formData.description,category:formData.category,tags:formData.tags.split(\",\").map(tag=>tag.trim()).filter(tag=>tag),videoFile:formData.videoFile,thumbnail:formData.thumbnail};// Simulate upload progress (in a real app, this would come from the upload request)\nconst progressInterval=setInterval(()=>{setUploadProgress(prev=>{if(prev>=90){clearInterval(progressInterval);return prev;}return prev+10;});},500);const result=await uploadVideo(uploadData);clearInterval(progressInterval);setUploadProgress(100);toast.success(\"Video uploaded successfully!\");// Redirect to the uploaded video\nnavigate(\"/video/\".concat(result.id));}catch(error){console.error(\"Upload failed:\",error);toast.error(error.message||\"Failed to upload video\");setUploadProgress(0);}finally{setUploading(false);}};// Format file size\nconst formatFileSize=bytes=>{if(bytes===0)return\"0 Bytes\";const k=1024;const sizes=[\"Bytes\",\"KB\",\"MB\",\"GB\"];const i=Math.floor(Math.log(bytes)/Math.log(k));return Number.parseFloat((bytes/Math.pow(k,i)).toFixed(2))+\" \"+sizes[i];};return/*#__PURE__*/_jsx(\"div\",{className:\"upload-video\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"upload-video__title\",children:\"Upload Video\"}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-video__subtitle\",children:\"Share your content with the world\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"upload-video__form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"upload-video__section-title\",children:\"Video File\"}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__drop-zone \".concat(dragActive?\"upload-video__drop-zone--active\":\"\",\" \").concat(formData.videoFile?\"upload-video__drop-zone--has-file\":\"\"),onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop,children:formData.videoFile?/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__file-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__file-icon\",children:\"\\uD83C\\uDFA5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__file-details\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"upload-video__file-name\",children:formData.videoFile.name}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-video__file-size\",children:formatFileSize(formData.videoFile.size)})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"upload-video__remove-file\",onClick:()=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{videoFile:null})),children:\"\\u2715\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__drop-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__drop-icon\",children:\"\\uD83D\\uDCC1\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"upload-video__drop-text\",children:[\"Drag and drop your video file here, or\",\" \",/*#__PURE__*/_jsxs(\"label\",{className:\"upload-video__file-label\",children:[\"browse\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"videoFile\",accept:\"video/*\",onChange:handleFileSelect,className:\"upload-video__file-input\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-video__drop-hint\",children:\"Supported formats: MP4, AVI, MOV, WMV (Max 500MB)\"})]})}),errors.videoFile&&/*#__PURE__*/_jsx(\"span\",{className:\"upload-video__error\",children:errors.videoFile})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"upload-video__section-title\",children:\"Thumbnail (Optional)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__thumbnail-upload\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"upload-video__thumbnail-label\",children:[formData.thumbnail?/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__thumbnail-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(formData.thumbnail)||\"/placeholder.svg\",alt:\"Thumbnail preview\",className:\"upload-video__thumbnail-image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__thumbnail-overlay\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Change thumbnail\"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__thumbnail-placeholder\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-video__thumbnail-icon\",children:\"\\uD83D\\uDDBC\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Upload thumbnail\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"thumbnail\",accept:\"image/*\",onChange:handleFileSelect,className:\"upload-video__file-input\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"upload-video__section-title\",children:\"Video Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",className:\"upload-video__label\",children:\"Title *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",name:\"title\",value:formData.title,onChange:handleChange,className:\"upload-video__input \".concat(errors.title?\"upload-video__input--error\":\"\"),placeholder:\"Enter video title\",maxLength:\"100\",disabled:uploading}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__char-count\",children:[formData.title.length,\"/100\"]}),errors.title&&/*#__PURE__*/_jsx(\"span\",{className:\"upload-video__error\",children:errors.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",className:\"upload-video__label\",children:\"Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",name:\"description\",value:formData.description,onChange:handleChange,className:\"upload-video__textarea \".concat(errors.description?\"upload-video__textarea--error\":\"\"),placeholder:\"Tell viewers about your video\",rows:\"5\",disabled:uploading}),errors.description&&/*#__PURE__*/_jsx(\"span\",{className:\"upload-video__error\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"category\",className:\"upload-video__label\",children:\"Category *\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"category\",name:\"category\",value:formData.category,onChange:handleChange,className:\"upload-video__select \".concat(errors.category?\"upload-video__select--error\":\"\"),disabled:uploading,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a category\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category))]}),errors.category&&/*#__PURE__*/_jsx(\"span\",{className:\"upload-video__error\",children:errors.category})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"tags\",className:\"upload-video__label\",children:\"Tags\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"tags\",name:\"tags\",value:formData.tags,onChange:handleChange,className:\"upload-video__input\",placeholder:\"Enter tags separated by commas\",disabled:uploading}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__hint\",children:\"Separate tags with commas (e.g., gaming, tutorial, fun)\"})]})]})]}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__progress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"upload-video__progress-fill\",style:{width:\"\".concat(uploadProgress,\"%\")}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"upload-video__progress-text\",children:[\"Uploading... \",uploadProgress,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-video__actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"upload-video__cancel-btn\",onClick:()=>navigate(\"/\"),disabled:uploading,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"upload-video__submit-btn\",disabled:uploading||!formData.videoFile,children:uploading?\"Uploading...\":\"Upload Video\"})]})]})]})});}export default UploadVideo;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}